(function(b){var r=0,t=function(a){a=Math.floor(a).toString(16);1===a.length&&(a="0"+a);return a.toLowerCase()},u=function(a,c){var d,e,f,g,l,p,h,n,m,k,q;a.sort(function(a,b){return a.pos[1]===b.pos[1]?a.pos[0]-b.pos[0]:a.pos[1]-b.pos[1]});l=g=0;b.each(a,function(a,b){g=Math.max(g,b.pos[0]+b.pos[2]);l=Math.max(l,b.pos[1]+b.pos[3])});d=[];for(e=0;e<g;++e)d.push([]);p=[];b.each(a,function(a,b){for(e=0;e<b.pos[2];e+=1)p[b.pos[0]+e]=!0;for(f=0;f<b.pos[3];f+=1);});m="";n=a[h=0];for(f=0;f<l;++f){m+="<tr>";
for(e=0;e<g;)if("undefined"!==typeof n&&e===n.pos[0]&&f===n.pos[1]){m+=c(n,e,f);for(q=0;q<n.pos[3];q+=1)for(k=0;k<n.pos[2];k+=1)d[e+k][f+q]=!0;e+=n.pos[2];n=a[++h]}else{k=0;for(q=!1;e<g&&void 0===d[e][f]&&(void 0===n||f<n.pos[1]||f===n.pos[1]&&e<n.pos[0]);)!0===p[e]&&(k+=1),q=!0,e+=1;0<k?m+='<td colspan="'+k+'"></td>':q||(e+=1)}m+="</tr>"}return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+m+"</tbody></table>"};b.colorpicker=new function(){this.regional={"":{ok:"OK",cancel:"Cancel",
none:"None",button:"Color",title:"Pick a color",transparent:"Transparent",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"}};this.swatches={html:{black:{r:0,g:0,b:0},dimgray:{r:.4117647058823529,g:.4117647058823529,b:.4117647058823529},gray:{r:.5019607843137255,g:.5019607843137255,b:.5019607843137255},darkgray:{r:.6627450980392157,g:.6627450980392157,b:.6627450980392157},silver:{r:.7529411764705882,
g:.7529411764705882,b:.7529411764705882},lightgrey:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},gainsboro:{r:.8627450980392157,g:.8627450980392157,b:.8627450980392157},whitesmoke:{r:.9607843137254902,g:.9607843137254902,b:.9607843137254902},white:{r:1,g:1,b:1},rosybrown:{r:.7372549019607844,g:.5607843137254902,b:.5607843137254902},indianred:{r:.803921568627451,g:.3607843137254902,b:.3607843137254902},brown:{r:.6470588235294118,g:.16470588235294117,b:.16470588235294117},firebrick:{r:.6980392156862745,
g:.13333333333333333,b:.13333333333333333},lightcoral:{r:.9411764705882353,g:.5019607843137255,b:.5019607843137255},maroon:{r:.5019607843137255,g:0,b:0},darkred:{r:.5450980392156862,g:0,b:0},red:{r:1,g:0,b:0},snow:{r:1,g:.9803921568627451,b:.9803921568627451},salmon:{r:.9803921568627451,g:.5019607843137255,b:.4470588235294118},mistyrose:{r:1,g:.8941176470588236,b:.8823529411764706},tomato:{r:1,g:.38823529411764707,b:.2784313725490196},darksalmon:{r:.9137254901960784,g:.5882352941176471,b:.47843137254901963},
orangered:{r:1,g:.27058823529411763,b:0},coral:{r:1,g:.4980392156862745,b:.3137254901960784},lightsalmon:{r:1,g:.6274509803921569,b:.47843137254901963},sienna:{r:.6274509803921569,g:.3215686274509804,b:.17647058823529413},seashell:{r:1,g:.9607843137254902,b:.9333333333333333},chocolate:{r:.8235294117647058,g:.4117647058823529,b:.11764705882352941},saddlebrown:{r:.5450980392156862,g:.27058823529411763,b:.07450980392156863},sandybrown:{r:.9568627450980393,g:.6431372549019608,b:.3764705882352941},peachpuff:{r:1,
g:.8549019607843137,b:.7254901960784313},peru:{r:.803921568627451,g:.5215686274509804,b:.24705882352941178},linen:{r:.9803921568627451,g:.9411764705882353,b:.9019607843137255},darkorange:{r:1,g:.5490196078431373,b:0},bisque:{r:1,g:.8941176470588236,b:.7686274509803922},burlywood:{r:.8705882352941177,g:.7215686274509804,b:.5294117647058824},tan:{r:.8235294117647058,g:.7058823529411765,b:.5490196078431373},antiquewhite:{r:.9803921568627451,g:.9215686274509803,b:.8431372549019608},navajowhite:{r:1,g:.8705882352941177,
b:.6784313725490196},blanchedalmond:{r:1,g:.9215686274509803,b:.803921568627451},papayawhip:{r:1,g:.9372549019607843,b:.8352941176470589},orange:{r:1,g:.6470588235294118,b:0},moccasin:{r:1,g:.8941176470588236,b:.7098039215686275},wheat:{r:.9607843137254902,g:.8705882352941177,b:.7019607843137254},oldlace:{r:.9921568627450981,g:.9607843137254902,b:.9019607843137255},floralwhite:{r:1,g:.9803921568627451,b:.9411764705882353},goldenrod:{r:.8549019607843137,g:.6470588235294118,b:.12549019607843137},darkgoldenrod:{r:.7215686274509804,
g:.5254901960784314,b:.043137254901960784},cornsilk:{r:1,g:.9725490196078431,b:.8627450980392157},gold:{r:1,g:.8431372549019608,b:0},palegoldenrod:{r:.9333333333333333,g:.9098039215686274,b:.6666666666666666},khaki:{r:.9411764705882353,g:.9019607843137255,b:.5490196078431373},lemonchiffon:{r:1,g:.9803921568627451,b:.803921568627451},darkkhaki:{r:.7411764705882353,g:.7176470588235294,b:.4196078431372549},beige:{r:.9607843137254902,g:.9607843137254902,b:.8627450980392157},lightgoldenrodyellow:{r:.9803921568627451,
g:.9803921568627451,b:.8235294117647058},olive:{r:.5019607843137255,g:.5019607843137255,b:0},yellow:{r:1,g:1,b:0},lightyellow:{r:1,g:1,b:.8784313725490196},ivory:{r:1,g:1,b:.9411764705882353},olivedrab:{r:.4196078431372549,g:.5568627450980392,b:.13725490196078433},yellowgreen:{r:.6039215686274509,g:.803921568627451,b:.19607843137254902},darkolivegreen:{r:.3333333333333333,g:.4196078431372549,b:.1843137254901961},greenyellow:{r:.6784313725490196,g:1,b:.1843137254901961},lawngreen:{r:.48627450980392156,
g:.9882352941176471,b:0},chartreuse:{r:.4980392156862745,g:1,b:0},darkseagreen:{r:.5607843137254902,g:.7372549019607844,b:.5607843137254902},forestgreen:{r:.13333333333333333,g:.5450980392156862,b:.13333333333333333},limegreen:{r:.19607843137254902,g:.803921568627451,b:.19607843137254902},lightgreen:{r:.5647058823529412,g:.9333333333333333,b:.5647058823529412},palegreen:{r:.596078431372549,g:.984313725490196,b:.596078431372549},darkgreen:{r:0,g:.39215686274509803,b:0},green:{r:0,g:.5019607843137255,
b:0},lime:{r:0,g:1,b:0},honeydew:{r:.9411764705882353,g:1,b:.9411764705882353},mediumseagreen:{r:.23529411764705882,g:.7019607843137254,b:.44313725490196076},seagreen:{r:.1803921568627451,g:.5450980392156862,b:.3411764705882353},springgreen:{r:0,g:1,b:.4980392156862745},mintcream:{r:.9607843137254902,g:1,b:.9803921568627451},mediumspringgreen:{r:0,g:.9803921568627451,b:.6039215686274509},mediumaquamarine:{r:.4,g:.803921568627451,b:.6666666666666666},aquamarine:{r:.4980392156862745,g:1,b:.8313725490196079},
turquoise:{r:.25098039215686274,g:.8784313725490196,b:.8156862745098039},lightseagreen:{r:.12549019607843137,g:.6980392156862745,b:.6666666666666666},mediumturquoise:{r:.2823529411764706,g:.8196078431372549,b:.8},darkslategray:{r:.1843137254901961,g:.30980392156862746,b:.30980392156862746},paleturquoise:{r:.6862745098039216,g:.9333333333333333,b:.9333333333333333},teal:{r:0,g:.5019607843137255,b:.5019607843137255},darkcyan:{r:0,g:.5450980392156862,b:.5450980392156862},darkturquoise:{r:0,g:.807843137254902,
b:.8196078431372549},aqua:{r:0,g:1,b:1},cyan:{r:0,g:1,b:1},lightcyan:{r:.8784313725490196,g:1,b:1},azure:{r:.9411764705882353,g:1,b:1},cadetblue:{r:.37254901960784315,g:.6196078431372549,b:.6274509803921569},powderblue:{r:.6901960784313725,g:.8784313725490196,b:.9019607843137255},lightblue:{r:.6784313725490196,g:.8470588235294118,b:.9019607843137255},deepskyblue:{r:0,g:.7490196078431373,b:1},skyblue:{r:.5294117647058824,g:.807843137254902,b:.9215686274509803},lightskyblue:{r:.5294117647058824,g:.807843137254902,
b:.9803921568627451},steelblue:{r:.27450980392156865,g:.5098039215686274,b:.7058823529411765},aliceblue:{r:.9411764705882353,g:.9725490196078431,b:1},dodgerblue:{r:.11764705882352941,g:.5647058823529412,b:1},slategray:{r:.4392156862745098,g:.5019607843137255,b:.5647058823529412},lightslategray:{r:.4666666666666667,g:.5333333333333333,b:.6},lightsteelblue:{r:.6901960784313725,g:.7686274509803922,b:.8705882352941177},cornflowerblue:{r:.39215686274509803,g:.5843137254901961,b:.9294117647058824},royalblue:{r:.2549019607843137,
g:.4117647058823529,b:.8823529411764706},midnightblue:{r:.09803921568627451,g:.09803921568627451,b:.4392156862745098},lavender:{r:.9019607843137255,g:.9019607843137255,b:.9803921568627451},navy:{r:0,g:0,b:.5019607843137255},darkblue:{r:0,g:0,b:.5450980392156862},mediumblue:{r:0,g:0,b:.803921568627451},blue:{r:0,g:0,b:1},ghostwhite:{r:.9725490196078431,g:.9725490196078431,b:1},darkslateblue:{r:.2823529411764706,g:.23921568627450981,b:.5450980392156862},slateblue:{r:.41568627450980394,g:.35294117647058826,
b:.803921568627451},mediumslateblue:{r:.4823529411764706,g:.40784313725490196,b:.9333333333333333},mediumpurple:{r:.5764705882352941,g:.4392156862745098,b:.8588235294117647},blueviolet:{r:.5411764705882353,g:.16862745098039217,b:.8862745098039215},indigo:{r:.29411764705882354,g:0,b:.5098039215686274},darkorchid:{r:.6,g:.19607843137254902,b:.8},darkviolet:{r:.5803921568627451,g:0,b:.8274509803921568},mediumorchid:{r:.7294117647058823,g:.3333333333333333,b:.8274509803921568},thistle:{r:.8470588235294118,
g:.7490196078431373,b:.8470588235294118},plum:{r:.8666666666666667,g:.6274509803921569,b:.8666666666666667},violet:{r:.9333333333333333,g:.5098039215686274,b:.9333333333333333},purple:{r:.5019607843137255,g:0,b:.5019607843137255},darkmagenta:{r:.5450980392156862,g:0,b:.5450980392156862},magenta:{r:1,g:0,b:1},fuchsia:{r:1,g:0,b:1},orchid:{r:.8549019607843137,g:.4392156862745098,b:.8392156862745098},mediumvioletred:{r:.7803921568627451,g:.08235294117647059,b:.5215686274509804},deeppink:{r:1,g:.0784313725490196,
b:.5764705882352941},hotpink:{r:1,g:.4117647058823529,b:.7058823529411765},palevioletred:{r:.8588235294117647,g:.4392156862745098,b:.5764705882352941},lavenderblush:{r:1,g:.9411764705882353,b:.9607843137254902},crimson:{r:.8627450980392157,g:.0784313725490196,b:.23529411764705882},pink:{r:1,g:.7529411764705882,b:.796078431372549},lightpink:{r:1,g:.7137254901960784,b:.7568627450980392}}};this.writers={"#HEX":function(a,b){return b._formatColor("#rxgxbx",a)},"#HEX3":function(a,c){var d=b.colorpicker.writers.HEX3(a);
return!1===d?!1:"#"+d},HEX:function(a,b){return b._formatColor("rxgxbx",a)},HEX3:function(a,b){var d=a.getRGB(),e=Math.floor(255*d.r),f=Math.floor(255*d.g),d=Math.floor(255*d.b);return e>>>4===(e&=15)&&f>>>4===(f&=15)&&d>>>4===(d&=15)?e.toString(16)+f.toString(16)+d.toString(16):!1},RGB:function(a,b){return 1<=a.getAlpha()?b._formatColor("rgb(rd,gd,bd)",a):!1},RGBA:function(a,b){return b._formatColor("rgba(rd,gd,bd,af)",a)},"RGB%":function(a,b){return 1<=a.getAlpha()?b._formatColor("rgb(rp%,gp%,bp%)",
a):!1},"RGBA%":function(a,b){return b._formatColor("rgba(rp%,gp%,bp%,af)",a)},HSL:function(a,b){return 1<=a.getAlpha()?b._formatColor("hsl(hd,sd,vd)",a):!1},HSLA:function(a,b){return b._formatColor("hsla(hd,sd,vd,af)",a)},"HSL%":function(a,b){return 1<=a.getAlpha()?b._formatColor("hsl(hp%,sp%,vp%)",a):!1},"HSLA%":function(a,b){return b._formatColor("hsla(hp%,sp%,vp%,af)",a)},NAME:function(a,b){return b._closestName(a)},EXACT:function(a,b){return b._exactName(a)}};this.parsers={"":function(a){if(""===
a)return new b.colorpicker.Color},NAME:function(a,c){var d=c._getSwatch(b.trim(a));if(d)return new b.colorpicker.Color(d.r,d.g,d.b)},RGBA:function(a){if(a=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(a))return new b.colorpicker.Color(a[1]/255,a[2]/255,a[3]/255,parseFloat(a[4]))},"RGBA%":function(a){if(a=/^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(a))return new b.colorpicker.Color(a[1]/
100,a[2]/100,a[3]/100,a[4]/100)},HSLA:function(a){if(a=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(a))return(new b.colorpicker.Color).setHSL(a[1]/255,a[2]/255,a[3]/255).setAlpha(parseFloat(a[4]))},"HSLA%":function(a){if(a=/^hsla?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(a))return(new b.colorpicker.Color).setHSL(a[1]/100,a[2]/100,a[3]/100).setAlpha(a[4]/100)},"#HEX":function(a){if(a=
/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(a))return new b.colorpicker.Color(parseInt(a[1],16)/255,parseInt(a[2],16)/255,parseInt(a[3],16)/255)},"#HEX3":function(a){if(a=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(a))return new b.colorpicker.Color(parseInt(String(a[1])+a[1],16)/255,parseInt(String(a[2])+a[2],16)/255,parseInt(String(a[3])+a[3],16)/255)},HEX:function(a){if(a=/^([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(a))return new b.colorpicker.Color(parseInt(a[1],
16)/255,parseInt(a[2],16)/255,parseInt(a[3],16)/255)},HEX3:function(a){if(a=/^([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(a))return new b.colorpicker.Color(parseInt(String(a[1])+a[1],16)/255,parseInt(String(a[2])+a[2],16)/255,parseInt(String(a[3])+a[3],16)/255)}};this.partslists={full:"header map bar hex hsv rgb alpha lab cmyk preview swatches footer".split(" "),popup:"map bar hex hsv rgb alpha preview footer".split(" "),draggable:"header map bar hex hsv rgb alpha preview footer".split(" "),inline:"map bar hex hsv rgb alpha preview".split(" ")};
this.limits={websafe:function(a){a.limit(6)},nibble:function(a){a.limit(16)},binary:function(a){a.limit(2)},name:function(a,b){var d=b._getSwatch(b._closestName(a));a.setRGB(d.r,d.g,d.b)}};this.parts={header:function(a){var c=null,d=function(){var b='<span class="ui-dialog-title">'+(a.options.title||a._getRegional("title"))+"</span>";!a.inline&&a.options.showCloseButton&&(b+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button"><span class="ui-icon ui-icon-closethick">close</span></a>');
return'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+b+"</div>"};this.init=function(){c=b(d()).prependTo(a.dialog);var e=b(".ui-dialog-titlebar-close",c);a._hoverable(e);a._focusable(e);e.click(function(b){b.preventDefault();a.close(a.options.revert)});!a.inline&&a.options.draggable&&a.dialog.draggable({handle:c})}},map:function(a){var c=this,d=null,e,f,g,l;e=function(c){if(a.opened){var h=b(".ui-colorpicker-map-layer-pointer",d),n=h.offset(),l=h.width(),h=h.height(),
k=c.pageX-n.left,n=c.pageY-n.top;0<=k&&k<l&&0<=n&&n<h&&(c.stopImmediatePropagation(),c.preventDefault(),d.unbind("mousedown",e),b(document).bind("mouseup",f),b(document).bind("mousemove",g),g(c))}};f=function(a){a.stopImmediatePropagation();a.preventDefault();b(document).unbind("mouseup",f);b(document).unbind("mousemove",g);d.bind("mousedown",e)};g=function(e){e.stopImmediatePropagation();e.preventDefault();if(e.pageX!==c.x||e.pageY!==c.y){c.x=e.pageX;c.y=e.pageY;var f=b(".ui-colorpicker-map-layer-pointer",
d),g=f.offset(),l=f.width(),f=f.height(),k=e.pageX-g.left;e=e.pageY-g.top;k=Math.max(0,Math.min(k/l,1));e=Math.max(0,Math.min(e/f,1));switch(a.mode){case "h":a.color.setHSV(null,k,1-e);break;case "s":case "a":a.color.setHSV(k,null,1-e);break;case "v":a.color.setHSV(k,1-e,null);break;case "r":a.color.setRGB(null,1-e,k);break;case "g":a.color.setRGB(1-e,null,k);break;case "b":a.color.setRGB(k,1-e,null)}a._change()}};l=function(){return'<div class="ui-colorpicker-map ui-colorpicker-map-'+(a.options.part.map.size||
256)+' ui-colorpicker-border"><span class="ui-colorpicker-map-layer-1">&nbsp;</span><span class="ui-colorpicker-map-layer-2">&nbsp;</span>'+(a.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':"")+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>'};this.update=function(){var e=65*(a.options.part.map.size||256)/64;switch(a.mode){case "h":b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 0",opacity:""}).show();
b(".ui-colorpicker-map-layer-2",d).hide();break;case "s":case "a":b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 "+-e+"px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",d).css({"background-position":"0 "+2*-e+"px",opacity:""}).show();break;case "v":b(d).css("background-color","black");b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 "+3*-e+"px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",d).hide();break;case "r":b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 "+
4*-e+"px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",d).css({"background-position":"0 "+5*-e+"px",opacity:""}).show();break;case "g":b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 "+6*-e+"px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",d).css({"background-position":"0 "+7*-e+"px",opacity:""}).show();break;case "b":b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 "+8*-e+"px",opacity:""}).show(),b(".ui-colorpicker-map-layer-2",d).css({"background-position":"0 "+
9*-e+"px",opacity:""}).show()}c.repaint()};this.repaint=function(){var c=b(".ui-colorpicker-map-layer-pointer",d),e=0,f=0;switch(a.mode){case "h":e=a.color.getHSV().s*c.width();f=(1-a.color.getHSV().v)*c.width();b(d).css("background-color",a.color.copy().setHSV(null,1,1).toCSS());break;case "s":case "a":e=a.color.getHSV().h*c.width();f=(1-a.color.getHSV().v)*c.width();b(".ui-colorpicker-map-layer-2",d).css("opacity",1-a.color.getHSV().s);break;case "v":e=a.color.getHSV().h*c.width();f=(1-a.color.getHSV().s)*
c.width();b(".ui-colorpicker-map-layer-1",d).css("opacity",a.color.getHSV().v);break;case "r":e=a.color.getRGB().b*c.width();f=(1-a.color.getRGB().g)*c.width();b(".ui-colorpicker-map-layer-2",d).css("opacity",a.color.getRGB().r);break;case "g":e=a.color.getRGB().b*c.width();f=(1-a.color.getRGB().r)*c.width();b(".ui-colorpicker-map-layer-2",d).css("opacity",a.color.getRGB().g);break;case "b":e=a.color.getRGB().r*c.width(),f=(1-a.color.getRGB().g)*c.width(),b(".ui-colorpicker-map-layer-2",d).css("opacity",
a.color.getRGB().b)}a.options.alpha&&b(".ui-colorpicker-map-layer-alpha",d).css("opacity",1-a.color.getAlpha());b(".ui-colorpicker-map-pointer",d).css({left:e-7,top:f-7})};this.init=function(){d=b(l()).appendTo(b(".ui-colorpicker-map-container",a.dialog));d.bind("mousedown",e)}},bar:function(a){var c=this,d=null,e,f,g,l;e=function(c){if(a.opened){var h=b(".ui-colorpicker-bar-layer-pointer",d),l=h.offset(),m=h.width(),h=h.height(),k=c.pageX-l.left,l=c.pageY-l.top;0<=k&&k<m&&0<=l&&l<h&&(c.stopImmediatePropagation(),
c.preventDefault(),d.unbind("mousedown",e),b(document).bind("mouseup",f),b(document).bind("mousemove",g),g(c))}};f=function(a){a.stopImmediatePropagation();a.preventDefault();b(document).unbind("mouseup",f);b(document).unbind("mousemove",g);d.bind("mousedown",e)};g=function(e){e.stopImmediatePropagation();e.preventDefault();if(e.pageY!==c.y){c.y=e.pageY;var f=b(".ui-colorpicker-bar-layer-pointer",d),g=f.offset(),f=f.height();e=e.pageY-g.top;e=Math.max(0,Math.min(e/f,1));switch(a.mode){case "h":a.color.setHSV(1-
e,null,null);break;case "s":a.color.setHSV(null,1-e,null);break;case "v":a.color.setHSV(null,null,1-e);break;case "r":a.color.setRGB(1-e,null,null);break;case "g":a.color.setRGB(null,1-e,null);break;case "b":a.color.setRGB(null,null,1-e);break;case "a":a.color.setAlpha(1-e)}a._change()}};l=function(){var b='<div class="ui-colorpicker-bar ui-colorpicker-bar-'+(a.options.part.bar.size||256)+'  ui-colorpicker-border"><span class="ui-colorpicker-bar-layer-1">&nbsp;</span><span class="ui-colorpicker-bar-layer-2">&nbsp;</span><span class="ui-colorpicker-bar-layer-3">&nbsp;</span><span class="ui-colorpicker-bar-layer-4">&nbsp;</span>';
a.options.alpha&&(b+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span><span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>');return b+'<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>'};this.update=function(){var e=65*(a.options.part.bar.size||256)/64;switch(a.mode){case "h":case "s":case "v":case "r":case "g":case "b":b(".ui-colorpicker-bar-layer-alpha",d).show();b(".ui-colorpicker-bar-layer-alphabar",d).hide();break;
case "a":b(".ui-colorpicker-bar-layer-alpha",d).hide(),b(".ui-colorpicker-bar-layer-alphabar",d).show()}switch(a.mode){case "h":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 0",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).hide();b(".ui-colorpicker-bar-layer-3",d).hide();b(".ui-colorpicker-bar-layer-4",d).hide();break;case "s":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 "+-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).css({"background-position":"0 "+
2*-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",d).hide();b(".ui-colorpicker-bar-layer-4",d).hide();break;case "v":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 "+2*-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).hide();b(".ui-colorpicker-bar-layer-3",d).hide();b(".ui-colorpicker-bar-layer-4",d).hide();break;case "r":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 "+6*-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).css({"background-position":"0 "+
5*-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",d).css({"background-position":"0 "+3*-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-4",d).css({"background-position":"0 "+4*-e+"px",opacity:""}).show();break;case "g":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 "+10*-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).css({"background-position":"0 "+9*-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",d).css({"background-position":"0 "+
7*-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-4",d).css({"background-position":"0 "+8*-e+"px",opacity:""}).show();break;case "b":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 "+14*-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).css({"background-position":"0 "+13*-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",d).css({"background-position":"0 "+11*-e+"px",opacity:""}).show();b(".ui-colorpicker-bar-layer-4",d).css({"background-position":"0 "+
12*-e+"px",opacity:""}).show();break;case "a":b(".ui-colorpicker-bar-layer-1",d).hide(),b(".ui-colorpicker-bar-layer-2",d).hide(),b(".ui-colorpicker-bar-layer-3",d).hide(),b(".ui-colorpicker-bar-layer-4",d).hide()}c.repaint()};this.repaint=function(){var e=b(".ui-colorpicker-bar-layer-pointer",d),c=0;switch(a.mode){case "h":c=(1-a.color.getHSV().h)*e.height();break;case "s":c=(1-a.color.getHSV().s)*e.height();b(".ui-colorpicker-bar-layer-2",d).css("opacity",1-a.color.getHSV().v);b(d).css("background-color",
a.color.copy().setHSV(null,1,null).toCSS());break;case "v":c=(1-a.color.getHSV().v)*e.height();b(d).css("background-color",a.color.copy().setHSV(null,null,1).toCSS());break;case "r":c=(1-a.color.getRGB().r)*e.height();b(".ui-colorpicker-bar-layer-2",d).css("opacity",Math.max(0,a.color.getRGB().b-a.color.getRGB().g));b(".ui-colorpicker-bar-layer-3",d).css("opacity",Math.max(0,a.color.getRGB().g-a.color.getRGB().b));b(".ui-colorpicker-bar-layer-4",d).css("opacity",Math.min(a.color.getRGB().b,a.color.getRGB().g));
break;case "g":c=(1-a.color.getRGB().g)*e.height();b(".ui-colorpicker-bar-layer-2",d).css("opacity",Math.max(0,a.color.getRGB().b-a.color.getRGB().r));b(".ui-colorpicker-bar-layer-3",d).css("opacity",Math.max(0,a.color.getRGB().r-a.color.getRGB().b));b(".ui-colorpicker-bar-layer-4",d).css("opacity",Math.min(a.color.getRGB().r,a.color.getRGB().b));break;case "b":c=(1-a.color.getRGB().b)*e.height();b(".ui-colorpicker-bar-layer-2",d).css("opacity",Math.max(0,a.color.getRGB().r-a.color.getRGB().g));b(".ui-colorpicker-bar-layer-3",
d).css("opacity",Math.max(0,a.color.getRGB().g-a.color.getRGB().r));b(".ui-colorpicker-bar-layer-4",d).css("opacity",Math.min(a.color.getRGB().r,a.color.getRGB().g));break;case "a":c=(1-a.color.getAlpha())*e.height(),b(d).css("background-color",a.color.copy().toCSS())}"a"!==a.mode&&b(".ui-colorpicker-bar-layer-alpha",d).css("opacity",1-a.color.getAlpha());b(".ui-colorpicker-bar-pointer",d).css("top",c-3)};this.init=function(){d=b(l()).appendTo(b(".ui-colorpicker-bar-container",a.dialog));d.bind("mousedown",
e)}},preview:function(a){var c=null,d;d=function(){return'<div class="ui-colorpicker-preview ui-colorpicker-border"><div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div><div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div></div>'};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-preview-container",a.dialog));b(".ui-colorpicker-preview-initial",c).click(function(){a.color=a.currentColor.copy();
a._change()})};this.update=function(){a.options.alpha?b(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",c).show():b(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",c).hide();this.repaint()};this.repaint=function(){b(".ui-colorpicker-preview-initial",c).css("background-color",a.currentColor.set?a.currentColor.toCSS():"").attr("title",a.currentColor.set?a.currentColor.toCSS():"");b(".ui-colorpicker-preview-initial-alpha",c).css("opacity",
1-a.currentColor.getAlpha());b(".ui-colorpicker-preview-current",c).css("background-color",a.color.set?a.color.toCSS():"").attr("title",a.color.set?a.color.toCSS():"");b(".ui-colorpicker-preview-current-alpha",c).css("opacity",1-a.color.getAlpha())}},hsv:function(a){var c=null,d;d=function(){var b="";a.options.hsv&&(b+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+a._getRegional("hsvH")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div><div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+
a._getRegional("hsvS")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+a._getRegional("hsvV")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>');return'<div class="ui-colorpicker-hsv">'+b+"</div>"};this.init=function(){c=
b(d()).appendTo(b(".ui-colorpicker-hsv-container",a.dialog));b(".ui-colorpicker-mode",c).click(function(){a.mode=b(this).val();a._updateAllParts()});b(".ui-colorpicker-number",c).bind("change keyup",function(){a.color.setHSV(b(".ui-colorpicker-hsv-h .ui-colorpicker-number",c).val()/360,b(".ui-colorpicker-hsv-s .ui-colorpicker-number",c).val()/100,b(".ui-colorpicker-hsv-v .ui-colorpicker-number",c).val()/100);a._change()})};this.repaint=function(){var e=a.color.getHSV();e.h*=360;e.s*=100;e.v*=100;
b.each(e,function(a,e){var d=b(".ui-colorpicker-hsv-"+a+" .ui-colorpicker-number",c);e=Math.round(e);parseInt(d.val(),10)!==e&&d.val(e)})};this.update=function(){b(".ui-colorpicker-mode",c).each(function(){b(this).attr("checked",b(this).val()===a.mode)});this.repaint()}},rgb:function(a){var c=null,d;d=function(){var b="";a.options.rgb&&(b+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+a._getRegional("rgbR")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+
a._getRegional("rgbG")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+a._getRegional("rgbB")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>');return'<div class="ui-colorpicker-rgb">'+b+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-rgb-container",a.dialog));b(".ui-colorpicker-mode",c).click(function(){a.mode=
b(this).val();a._updateAllParts()});b(".ui-colorpicker-number",c).bind("change keyup",function(){b(".ui-colorpicker-rgb-r .ui-colorpicker-number",c).val();a.color.setRGB(b(".ui-colorpicker-rgb-r .ui-colorpicker-number",c).val()/255,b(".ui-colorpicker-rgb-g .ui-colorpicker-number",c).val()/255,b(".ui-colorpicker-rgb-b .ui-colorpicker-number",c).val()/255);a._change()})};this.repaint=function(){b.each(a.color.getRGB(),function(a,d){var g=b(".ui-colorpicker-rgb-"+a+" .ui-colorpicker-number",c);d=Math.floor(255*
d);parseInt(g.val(),10)!==d&&g.val(d)})};this.update=function(){b(".ui-colorpicker-mode",c).each(function(){b(this).attr("checked",b(this).val()===a.mode)});this.repaint()}},lab:function(a){var c=null,d=function(){var b="";a.options.hsv&&(b+='<div class="ui-colorpicker-lab-l"><label>'+a._getRegional("labL")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div><div class="ui-colorpicker-lab-a"><label>'+a._getRegional("labA")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div><div class="ui-colorpicker-lab-b"><label>'+
a._getRegional("labB")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>');return'<div class="ui-colorpicker-lab">'+b+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-lab-container",a.dialog));b(".ui-colorpicker-number",c).bind("change keyup",function(e){a.color.setLAB(parseInt(b(".ui-colorpicker-lab-l .ui-colorpicker-number",c).val(),10)/100,(parseInt(b(".ui-colorpicker-lab-a .ui-colorpicker-number",c).val(),10)+128)/255,(parseInt(b(".ui-colorpicker-lab-b .ui-colorpicker-number",
c).val(),10)+128)/255);a._change()})};this.repaint=function(){var e=a.color.getLAB();e.l*=100;e.a=255*e.a-128;e.b=255*e.b-128;b.each(e,function(a,e){var d=b(".ui-colorpicker-lab-"+a+" .ui-colorpicker-number",c);e=Math.round(e);parseInt(d.val(),10)!==e&&d.val(e)})};this.update=function(){this.repaint()}},cmyk:function(a){var c=null,d=function(){var b="";a.options.hsv&&(b+='<div class="ui-colorpicker-cmyk-c"><label>'+a._getRegional("cmykC")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-m"><label>'+
a._getRegional("cmykM")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-y"><label>'+a._getRegional("cmykY")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-k"><label>'+a._getRegional("cmykK")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>');
return'<div class="ui-colorpicker-cmyk">'+b+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-cmyk-container",a.dialog));b(".ui-colorpicker-number",c).bind("change keyup",function(e){a.color.setCMYK(parseInt(b(".ui-colorpicker-cmyk-c .ui-colorpicker-number",c).val(),10)/100,parseInt(b(".ui-colorpicker-cmyk-m .ui-colorpicker-number",c).val(),10)/100,parseInt(b(".ui-colorpicker-cmyk-y .ui-colorpicker-number",c).val(),10)/100,parseInt(b(".ui-colorpicker-cmyk-k .ui-colorpicker-number",
c).val(),10)/100);a._change()})};this.repaint=function(){b.each(a.color.getCMYK(),function(a,d){var g=b(".ui-colorpicker-cmyk-"+a+" .ui-colorpicker-number",c);d=Math.round(100*d);parseInt(g.val(),10,10)!==d&&g.val(d)})};this.update=function(){this.repaint()}},alpha:function(a){var c=null,d;d=function(){var b="";a.options.alpha&&(b+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+a._getRegional("alphaA")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>');
return'<div class="ui-colorpicker-alpha">'+b+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-alpha-container",a.dialog));b(".ui-colorpicker-mode",c).click(function(){a.mode=b(this).val();a._updateAllParts()});b(".ui-colorpicker-number",c).bind("change keyup",function(){a.color.setAlpha(b(".ui-colorpicker-a .ui-colorpicker-number",c).val()/100);a._change()})};this.update=function(){b(".ui-colorpicker-mode",c).each(function(){b(this).attr("checked",b(this).val()===a.mode)});this.repaint()};
this.repaint=function(){var e=b(".ui-colorpicker-a .ui-colorpicker-number",c),d=Math.round(100*a.color.getAlpha());parseInt(e.val(),10)!==d&&e.val(d)}},hex:function(a){var c=null,d;d=function(){var b="";a.options.alpha&&(b+='<input class="ui-colorpicker-hex-alpha" type="text" maxlength="2" size="2"/>');return'<div class="ui-colorpicker-hex"><label>#</label>'+(b+'<input class="ui-colorpicker-hex-input" type="text" maxlength="6" size="6"/>')+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-hex-container",
a.dialog));b(".ui-colorpicker-hex-input",c).bind("change keydown keyup",function(a,c,d){/[^a-fA-F0-9]/.test(b(this).val())&&b(this).val(b(this).val().replace(/[^a-fA-F0-9]/,""))});b(".ui-colorpicker-hex-input",c).bind("change keyup",function(){var c;c=b(this).val();(c=/^#?([a-fA-F0-9]{1,6})$/.exec(c))?(c=parseInt(c[1],16),c=new b.colorpicker.Color((c>>16&255)/255,(c>>8&255)/255,(c&255)/255)):c=new b.colorpicker.Color;a.color=c.setAlpha(a.color.getAlpha());a._change()});b(".ui-colorpicker-hex-alpha",
c).bind("change keydown keyup",function(){/[^a-fA-F0-9]/.test(b(this).val())&&b(this).val(b(this).val().replace(/[^a-fA-F0-9]/,""))});b(".ui-colorpicker-hex-alpha",c).bind("change keyup",function(){a.color.setAlpha(parseInt(b(".ui-colorpicker-hex-alpha",c).val(),16)/255);a._change()})};this.update=function(){this.repaint()};this.repaint=function(){b(".ui-colorpicker-hex-input",c).is(":focus")||b(".ui-colorpicker-hex-input",c).val(a.color.toHex(!0));b(".ui-colorpicker-hex-alpha",c).is(":focus")||b(".ui-colorpicker-hex-alpha",
c).val(t(255*a.color.getAlpha()))}},swatches:function(a){var c=null,d=function(){var c="";b.each(a._getSwatches(),function(a,d){var l=(new b.colorpicker.Color(d.r,d.g,d.b)).toCSS();c+='<div class="ui-colorpicker-swatch" style="background-color:'+l+'" title="'+a+'"></div>'});return'<div class="ui-colorpicker-swatches ui-colorpicker-border" style="width:'+a.options.swatchesWidth+'px">'+c+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-swatches-container",a.dialog));b(".ui-colorpicker-swatch",
c).click(function(){a.color=a._parseColor(b(this).css("background-color"));a._change()})}},footer:function(a){var c=null,d="ui-colorpicker-special-transparent-"+r,e="ui-colorpicker-special-none-"+r,f=function(){var b="";if(a.options.alpha||!a.inline&&a.options.showNoneButton)b+='<div class="ui-colorpicker-buttonset">',a.options.alpha&&(b+='<input type="radio" name="ui-colorpicker-special" id="'+d+'" class="ui-colorpicker-special-transparent"/><label for="'+d+'">'+a._getRegional("transparent")+"</label>"),
!a.inline&&a.options.showNoneButton&&(b+='<input type="radio" name="ui-colorpicker-special" id="'+e+'" class="ui-colorpicker-special-none"><label for="'+e+'">'+a._getRegional("none")+"</label>"),b+="</div>";a.inline||(b+='<div class="ui-dialog-buttonset">',a.options.showCancelButton&&(b+='<button class="ui-colorpicker-cancel">'+a._getRegional("cancel")+"</button>"),b+='<button class="ui-colorpicker-ok">'+a._getRegional("ok")+"</button>",b+="</div>");return'<div class="ui-dialog-buttonpane ui-widget-content">'+
b+"</div>"};this.init=function(){c=b(f()).appendTo(a.dialog);b(".ui-colorpicker-ok",c).button().click(function(){a.close()});b(".ui-colorpicker-cancel",c).button().click(function(){a.close(!0)});b(".ui-colorpicker-buttonset",c).buttonset();b(".ui-colorpicker-special-color",c).click(function(){a._change()});b("#"+e,c).click(function(){a.color.set=!1;a._change()});b("#"+d,c).click(function(){a.color.setAlpha(0);a._change()})};this.repaint=function(){a.color.set?0===a.color.getAlpha()?b(".ui-colorpicker-special-transparent",
c).attr("checked",!0).button("refresh"):b("input",c).attr("checked",!1).button("refresh"):b(".ui-colorpicker-special-none",c).attr("checked",!0).button("refresh");b(".ui-colorpicker-cancel",c).button(a.changed?"enable":"disable")};this.update=function(){}}};this.Color=function(){var a={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},c=1,d=[.9504285,1,1.0889],e=arguments,f=function(a){if(isNaN(a)||null===a)return 0;"string"==typeof a&&(a=parseInt(a,10));
return Math.max(0,Math.min(a,1))},g=function(a){var b=a%16;return"0123456789abcdef".charAt((a-b)/16)+"0123456789abcdef".charAt(b)},l=function(a){var b=.04045<a.r?Math.pow((a.r+.055)/1.055,2.4):a.r/12.92,c=.04045<a.g?Math.pow((a.g+.055)/1.055,2.4):a.g/12.92;a=.04045<a.b?Math.pow((a.b+.055)/1.055,2.4):a.b/12.92;return{x:.4124*b+.3576*c+.1805*a,y:.2126*b+.7152*c+.0722*a,z:.0193*b+.1192*c+.9505*a}},p=function(a){var b=Math.max(a.r,a.g,a.b),c=b-Math.min(a.r,a.g,a.b),d,e,f={h:0,s:0,v:b};0===c?(f.h=0,f.s=
0):(f.s=c/b,d=((b-a.r)/6+c/2)/c,e=((b-a.g)/6+c/2)/c,c=((b-a.b)/6+c/2)/c,a.r===b?f.h=c-e:a.g===b?f.h=1/3+d-c:a.b===b&&(f.h=2/3+e-d),0>f.h?f.h+=1:1<f.h&&--f.h);return f},h=function(a){var b=Math.min(a.r,a.g,a.b),c=Math.max(a.r,a.g,a.b),d=c-b,e,f={h:0,s:0,l:(c+b)/2};0===d?(f.h=0,f.s=0):(f.s=.5>f.l?d/(c+b):d/(2-c-b),b=((c-a.r)/6+d/2)/d,e=((c-a.g)/6+d/2)/d,d=((c-a.b)/6+d/2)/d,a.r===c?f.h=d-e:a.g===c?f.h=1/3+b-d:a.b===c&&(f.h=2/3+e-b),0>f.h?f.h+=1:1<f.h&&--f.h);return f},n=function(a){var b,c,d=function(a,
b,c){0>c&&(c+=1);1<c&&--c;return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a};if(0===a.s)return{r:a.l,g:a.l,b:a.l};c=.5>a.l?a.l*(1+a.s):a.l+a.s-a.s*a.l;b=2*a.l-c;return{r:d(b,c,a.h+1/3),g:d(b,c,a.h),b:d(b,c,a.h-1/3)}},m=function(a){var b=a.x/d[0],c=a.y/d[1];a=a.z/d[2];b=.008856<b?Math.pow(b,1/3):7.787*b+16/116;c=.008856<c?Math.pow(c,1/3):7.787*c+16/116;a=.008856<a?Math.pow(a,1/3):7.787*a+16/116;return{l:(116*c-16)/100,a:(500*(b-c)+128)/255,b:(200*(c-a)+128)/255}},k=function(a){return{c:1-
a.r,m:1-a.g,y:1-a.b}},q=function(a){var b=1;a.c<b&&(b=a.c);a.m<b&&(b=a.m);a.y<b&&(b=a.y);return 1===b?{c:0,m:0,y:0,k:1}:{c:(a.c-b)/(1-b),m:(a.m-b)/(1-b),y:(a.y-b)/(1-b),k:b}};this.set=!1;this.setAlpha=function(a){null!==a&&(c=f(a));this.set=!0;return this};this.getAlpha=function(){return c};this.setRGB=function(b,c,d){a={rgb:this.getRGB()};null!==b&&(a.rgb.r=f(b));null!==c&&(a.rgb.g=f(c));null!==d&&(a.rgb.b=f(d));this.set=!0;return this};this.setHSV=function(b,c,d){a={hsv:this.getHSV()};null!==b&&
(a.hsv.h=f(b));null!==c&&(a.hsv.s=f(c));null!==d&&(a.hsv.v=f(d));this.set=!0;return this};this.setHSL=function(b,c,d){a={hsl:this.getHSL()};null!==b&&(a.hsl.h=f(b));null!==c&&(a.hsl.s=f(c));null!==d&&(a.hsl.l=f(d));this.set=!0;return this};this.setLAB=function(b,c,d){a={lab:this.getLAB()};null!==b&&(a.lab.l=f(b));null!==c&&(a.lab.a=f(c));null!==d&&(a.lab.b=f(d));this.set=!0;return this};this.setCMYK=function(b,c,d,e){a={cmyk:this.getCMYK()};null!==b&&(a.cmyk.c=f(b));null!==c&&(a.cmyk.m=f(c));null!==
d&&(a.cmyk.y=f(d));null!==e&&(a.cmyk.k=f(e));this.set=!0;return this};this.getRGB=function(){var c,e,g;if(!a.rgb){var l=a;if(a.lab){c=a.lab;e=255*c.b-128;g=0;var h=(100*c.l+16)/116,k=0;g=(255*c.a-128)/500+h;k=h-e/200;g=.008856<Math.pow(g,3)?Math.pow(g,3):(g-16/116)/7.787;h=.008856<Math.pow(h,3)?Math.pow(h,3):(h-16/116)/7.787;k=.008856<Math.pow(k,3)?Math.pow(k,3):(k-16/116)/7.787;g*=d[0];h*=d[1];k*=d[2];c={r:3.2406*g+-1.5372*h+-.4986*k,g:-.9689*g+1.8758*h+.0415*k,b:.0557*g+-.204*h+1.057*k};c.r=.0031308<
c.r?1.055*Math.pow(c.r,1/2.4)-.055:12.92*c.r;c.g=.0031308<c.g?1.055*Math.pow(c.g,1/2.4)-.055:12.92*c.g;c.b=.0031308<c.b?1.055*Math.pow(c.b,1/2.4)-.055:12.92*c.b}else if(a.hsv){c=a.hsv;e={r:0,g:0,b:0};var m;0===c.s?e.r=e.g=e.b=c.v:(m=1===c.h?0:6*c.h,g=Math.floor(m),h=c.v*(1-c.s),k=c.v*(1-c.s*(m-g)),m=c.v*(1-c.s*(1-(m-g))),0===g?(e.r=c.v,e.g=m,e.b=h):1===g?(e.r=k,e.g=c.v,e.b=h):2===g?(e.r=h,e.g=c.v,e.b=m):3===g?(e.r=h,e.g=k,e.b=c.v):4===g?(e.r=m,e.g=h,e.b=c.v):(e.r=c.v,e.g=h,e.b=k));c=e}else a.hsl?
c=n(a.hsl):a.cmyk?(g=a.cmyk,c=g.c*(1-g.k)+g.k,e=g.m*(1-g.k)+g.k,g=g.y*(1-g.k)+g.k,c={r:1-c,g:1-e,b:1-g}):c={r:0,g:0,b:0};l.rgb=c;a.rgb.r=f(a.rgb.r);a.rgb.g=f(a.rgb.g);a.rgb.b=f(a.rgb.b)}return b.extend({},a.rgb)};this.getHSV=function(){a.hsv||(a.hsv=a.lab?p(this.getRGB()):a.rgb?p(a.rgb):a.hsl?p(this.getRGB()):a.cmyk?p(this.getRGB()):{h:0,s:0,v:0},a.hsv.h=f(a.hsv.h),a.hsv.s=f(a.hsv.s),a.hsv.v=f(a.hsv.v));return b.extend({},a.hsv)};this.getHSL=function(){a.hsl||(a.hsl=a.rgb?h(a.rgb):a.hsv?h(this.getRGB()):
a.cmyk?h(this.getRGB()):a.hsv?h(this.getRGB()):{h:0,s:0,l:0},a.hsl.h=f(a.hsl.h),a.hsl.s=f(a.hsl.s),a.hsl.l=f(a.hsl.l));return b.extend({},a.hsl)};this.getCMYK=function(){a.cmyk||(a.cmyk=a.rgb?q(k(a.rgb)):a.hsv?q(k(this.getRGB())):a.hsl?q(k(this.getRGB())):a.lab?q(k(this.getRGB())):{c:0,m:0,y:0,k:1},a.cmyk.c=f(a.cmyk.c),a.cmyk.m=f(a.cmyk.m),a.cmyk.y=f(a.cmyk.y),a.cmyk.k=f(a.cmyk.k));return b.extend({},a.cmyk)};this.getLAB=function(){a.lab||(a.lab=a.rgb?m(l(a.rgb)):a.hsv?m(l(this.getRGB())):a.hsl?m(l(this.getRGB())):
a.cmyk?m(l(this.getRGB())):{l:0,a:0,b:0},a.lab.l=f(a.lab.l),a.lab.a=f(a.lab.a),a.lab.b=f(a.lab.b));return b.extend({},a.lab)};this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v,c:this.getCMYK().c,m:this.getCMYK().m,y:this.getCMYK().y,k:this.getCMYK().k,L:this.getLAB().l,A:this.getLAB().a,B:this.getLAB().b}};this.getSpaces=function(){return b.extend(!0,{},a)};this.distance=function(a){var b=
this.getLAB();a=a.getLAB();var c=0,d;for(d in b)c+=Math.pow(b[d]-a[d],2);return c};this.equals=function(a){var b=this.getRGB(),c=a.getRGB();return this.getAlpha()===a.getAlpha()&&b.r===c.r&&b.g===c.g&&b.b===c.b};this.limit=function(a){--a;var b=this.getRGB();this.setRGB(Math.round(b.r*a)/a,Math.round(b.g*a)/a,Math.round(b.b*a)/a)};this.toHex=function(){var a=this.getRGB();return g(255*a.r)+g(255*a.g)+g(255*a.b)};this.toCSS=function(){return"#"+this.toHex()};this.copy=function(){var a=new b.colorpicker.Color(this.getSpaces(),
this.getAlpha());a.set=this.set;return a};2===e.length&&(a=e[0],this.setAlpha(0===e[1]?0:e[1]||1),this.set=!0);2<e.length&&(this.setRGB(e[0],e[1],e[2]),this.setAlpha(0===e[3]?0:e[3]||1),this.set=!0)}};b.widget("vanderlee.colorpicker",{options:{alpha:!1,altAlpha:!0,altField:"",altOnChange:!0,altProperties:"background-color",autoOpen:!1,buttonClass:null,buttonColorize:!1,buttonImage:"images/ui-colorpicker.png",buttonImageOnly:!1,buttonText:null,closeOnEscape:!0,closeOnOutside:!0,color:"#00FF00",colorFormat:"HEX",
draggable:!0,duration:"fast",hsv:!0,inline:!0,inlineFrame:!0,layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:"",modal:!1,mode:"h",okOnEnter:!1,parts:"",part:{map:{size:256},bar:{size:256}},regional:"",revert:!1,rgb:!0,showAnim:"fadeIn",showCancelButton:!0,showNoneButton:!1,showCloseButton:!0,showOn:"focus click alt",showOptions:{},swatches:null,swatchesWidth:84,title:null,cancel:null,
close:null,init:null,select:null,ok:null,open:null},_create:function(){var a=this,c;++r;a.widgetEventPrefix="colorpicker";a.opened=!1;a.generated=!1;a.inline=!1;a.changed=!1;a.dialog=null;a.button=null;a.image=null;a.overlay=null;a.mode=a.options.mode;a.element.is("input")||!1===a.options.inline?(a._setColor(a.element.is("input")?a.element.val():a.options.color),a._callback("init"),/\bfocus|both\b/.test(a.options.showOn)&&a.element.bind("focus",function(){a.open()}),/\bclick|both\b/.test(a.options.showOn)&&
a.element.bind("click",function(){a.open()}),/\bbutton|both\b/.test(a.options.showOn)&&(""!==a.options.buttonImage&&(c=a.options.buttonText||a._getRegional("button"),a.image=b("<img/>").attr({src:a.options.buttonImage,alt:c,title:c}),a.options.buttonClass&&a.image.attr("class",a.options.buttonClass),a._setImageBackground()),a.options.buttonImageOnly&&a.image?a.button=a.image:(a.button=b('<button type="button"></button>').html(a.image||a.options.buttonText).button(),a.image=a.image?b("img",a.button).first():
null),a.button.insertAfter(a.element).click(function(){a[a.opened?"close":"open"]()})),/\balt|both\b/.test(a.options.showOn)&&b(a.options.altField).bind("click",function(){a.open()}),a.options.autoOpen&&a.open()):(a.inline=!0,a._generate(),a.opened=!0);return this},_setOption:function(a,c){switch(a){case "disabled":c?this.dialog.addClass("ui-colorpicker-disabled"):this.dialog.removeClass("ui-colorpicker-disabled")}b.Widget.prototype._setOption.apply(this,arguments)},_setImageBackground:function(){this.image&&
this.options.buttonColorize&&this.image.css("background-color",this.color.set?this._formatColor("RGBA",this.color):"")},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var a,c,d=this.options.altProperties.split(",");for(a=0;a<=d.length;++a)switch(c=b.trim(d[a]),c){case "color":case "background-color":case "backgroundColor":case "outline-color":case "border-color":b(this.options.altField).css(c,this.color.set?this.color.toCSS():"")}this.options.altAlpha&&
b(this.options.altField).css("opacity",this.color.set?this.color.getAlpha():"")}},_setColor:function(a){this.color=this._parseColor(a);this.currentColor=this.color.copy();this._setImageBackground();this._setAltField()},setColor:function(a){this._setColor(a);this._change()},getColor:function(a){return this._formatColor(a||this.options.colorFormat,this.color)},_generateInline:function(){b(this.element).html(this.options.inlineFrame?'<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>':
'<div class="ui-colorpicker ui-colorpicker-inline"></div>');this.dialog=b(".ui-colorpicker",this.element)},_generatePopup:function(){var a=this;b("body").append('<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>');a.dialog=b(".ui-colorpicker:last");b(document).delegate("html","touchstart click",function(c){if(a.opened&&c.target!==a.element[0]&&!a.overlay)if(a.dialog.is(c.target)||0<a.dialog.has(c.target).length)a.element.blur();
else{var d=b(c.target).parents();d.push(c.target);for(c=0;c<=d.length;++c)if(null!==a.button&&d[c]===a.button[0]||/\balt|both\b/.test(a.options.showOn)&&b(a.options.altField).is(d[c]))return;a.options.closeOnOutside&&a.close(a.options.revert)}});b(document).keydown(function(b){a.opened&&27===b.keyCode&&a.options.closeOnEscape&&a.close(a.options.revert);a.opened&&13===b.keyCode&&a.options.okOnEnter&&a.close()});a.element.keydown(function(b){9===b.keyCode&&a.close()}).keyup(function(b){b=a._parseColor(a.element.val());
a.color.equals(b)||(a.color=b,a._change())})},_generate:function(){var a=this,c,d,e;a._setColor(a.inline||!a.element.is("input")?a.options.color:a.element.val());a[a.inline?"_generateInline":"_generatePopup"]();c="string"===typeof a.options.parts?b.colorpicker.partslists[a.options.parts]?b.colorpicker.partslists[a.options.parts]:b.colorpicker.partslists[a.inline?"inline":"popup"]:a.options.parts;a.parts={};b.each(c,function(c,d){b.colorpicker.parts[d]&&(a.parts[d]=new b.colorpicker.parts[d](a))});
a.generated||(d=[],b.each(a.options.layout,function(b,c){a.parts[b]&&d.push({part:b,pos:c})}),c=b(u(d,function(a,b,c){e=["ui-colorpicker-"+a.part+"-container"];0<b&&e.push("ui-colorpicker-padding-left");0<c&&e.push("ui-colorpicker-padding-top");return'<td  class="'+e.join(" ")+'"'+(1<a.pos[2]?' colspan="'+a.pos[2]+'"':"")+(1<a.pos[3]?' rowspan="'+a.pos[3]+'"':"")+' valign="top"></td>'})).appendTo(a.dialog),a.options.inlineFrame&&c.addClass("ui-dialog-content ui-widget-content"),a._initAllParts(),
a._updateAllParts(),a.generated=!0)},_effectGeneric:function(a,c,d,e,f){if(b.effects&&b.effects[this.options.showAnim])a[c](this.options.showAnim,this.options.showOptions,this.options.duration,f);else a["slideDown"===this.options.showAnim?d:"fadeIn"===this.options.showAnim?e:c](this.options.showAnim?this.options.duration:null,f),this.options.showAnim&&this.options.duration||f()},_effectShow:function(a,b){this._effectGeneric(a,"show","slideDown","fadeIn",b)},_effectHide:function(a,b){this._effectGeneric(a,
"hide","slideUp","fadeOut",b)},open:function(){var a=this,c,d,e,f,g,l,p,h;a.opened||(a._generate(),a.element.is(":hidden")?(d=b("<div/>").insertBefore(a.element),c=d.offset(),d.remove()):c=a.element.offset(),d=b(window).height()+b(window).scrollTop(),e=b(window).width()+b(window).scrollLeft(),f=a.dialog.outerHeight(!1),g=a.dialog.outerWidth(),l=c.left,p=c.top+a.element.outerHeight(!1),l+g>e&&(l=Math.max(0,e-g)),p+f>d&&(p=c.top-f>=b(window).scrollTop()?c.top-f:Math.max(0,d-f)),a.dialog.css({left:l,
top:p}),h=0,b(a.element[0]).parents().each(function(){var a=b(this).css("z-index");if("number"!==typeof a&&"string"!==typeof a||""===a||isNaN(a))b(this).siblings().each(function(){var a=b(this).css("z-index");"number"!==typeof a&&"string"!==typeof a||""===a||isNaN(a)||a>h&&(h=parseInt(a,10))});else if(a>h)return h=parseInt(a,10),!1}),a.dialog.css("z-index",h+=2),a.overlay=a.options.modal?new b.ui.dialog.overlay(a):null,null!==a.overlay&&(c=a.overlay.$el.css("z-index"),"number"!==typeof c&&"string"!==
typeof c||""===c||isNaN(c)||a.dialog.css("z-index",h+c+2)),a._effectShow(this.dialog),a.opened=!0,a._callback("open",!0),b(function(){a._repaintAllParts()}))},close:function(a){var b=this;a?(b.color=b.currentColor.copy(),b._change(),b._callback("cancel",!0)):(b.currentColor=b.color.copy(),b._callback("ok",!0));b.changed=!1;b._effectHide(b.dialog,function(){b.dialog.remove();b.dialog=null;b.generated=!1;b.opened=!1;b._callback("close",!0)});b.overlay&&b.overlay.destroy()},destroy:function(){this.element.unbind();
null!==this.image&&this.image.remove();null!==this.button&&this.button.remove();null!==this.dialog&&this.dialog.remove();this.overlay&&this.overlay.destroy()},_callback:function(a,b){var d,e;return this.color.set?(d={formatted:this._formatColor(this.options.colorFormat,this.color),colorPicker:this},e=this.color.getLAB(),e.a=2*e.a-1,e.b=2*e.b-1,!0===b&&(d.a=this.color.getAlpha(),d.rgb=this.color.getRGB(),d.hsv=this.color.getHSV(),d.cmyk=this.color.getCMYK(),d.hsl=this.color.getHSL(),d.lab=e),this._trigger(a,
null,d)):this._trigger(a,null,{formatted:"",colorPicker:this})},_initAllParts:function(){b.each(this.parts,function(a,b){b.init&&b.init()})},_updateAllParts:function(){b.each(this.parts,function(a,b){b.update&&b.update()})},_repaintAllParts:function(){b.each(this.parts,function(a,b){b.repaint&&b.repaint()})},_change:function(){this.changed=!0;if(this.options.limit&&b.colorpicker.limits[this.options.limit])b.colorpicker.limits[this.options.limit](this.color,this);this.inline||(this.color.set?this.color.equals(this._parseColor(this.element.val()))||
(this.element.val(this._formatColor(this.options.colorFormat,this.color)),this.element.css("background-color","#"+this._formatColor(this.options.colorFormat,this.color))):this.element.val(""),this._setImageBackground(),this._setAltField());this.options.color=this.color.set?this.color.toCSS():"";this.opened&&this._repaintAllParts();this._callback("select")},_hoverable:function(a){a.hover(function(){a.addClass("ui-state-hover")},function(){a.removeClass("ui-state-hover")})},_focusable:function(a){a.focus(function(){a.addClass("ui-state-focus")}).blur(function(){a.removeClass("ui-state-focus")})},
_getRegional:function(a){return void 0!==b.colorpicker.regional[this.options.regional][a]?b.colorpicker.regional[this.options.regional][a]:b.colorpicker.regional[""][a]},_getSwatches:function(){return"string"===typeof this.options.swatches?b.colorpicker.swatches[this.options.swatches]:b.isPlainObject(this.options.swatches)?this.colorpicker.swatches:b.colorpicker.swatches.html},_getSwatch:function(a){var c=this._getSwatches(),d=!1;if(void 0!==c[a])return c[a];b.each(c,function(b,c){return b.toLowerCase()==
a.toLowerCase()?(d=c,!1):!0});return d},_parseColor:function(a){var c=this,d;b.each(b.colorpicker.parsers,function(b,f){if(d=f(a,c))return!1});return d?d:new b.colorpicker.Color},_exactName:function(a){var c=!1;b.each(this._getSwatches(),function(d,e){return a.equals(new b.colorpicker.Color(e.r,e.g,e.b))?(c=d,!1):!0});return c},_closestName:function(a){a.getRGB();var c=null,d=!1,e;b.each(this._getSwatches(),function(f,g){e=a.distance(new b.colorpicker.Color(g.r,g.g,g.b));if(e<c||null===c){d=f;if(0===
e)return!1;c=e}return!0});return d},_formatColor:function(a,c){var d=this,e=null,f={x:function(a){return t(255*a)},d:function(a){return Math.floor(255*a)},f:function(a){return a},p:function(a){return 100*a}},g=c.getChannels();b.isArray(a)||(a=[a]);b.each(a,function(a,p){if(b.colorpicker.writers[p])return e=b.colorpicker.writers[p](c,d),!1===e;e=p.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(a){return a.match(/^\\/)?a.slice(1):f[a.charAt(1)](g[a.charAt(0)])});return!1});return e}})})(jQuery);
